net add node 0.0.0.1
net add node 0.0.0.2
net add node 0.0.0.3
net add node 0.0.0.4
net add node 0.0.0.5
net add node 0.0.0.6
net add node 0.0.0.7
net add link 0.0.0.1 0.0.0.2
net add link 0.0.0.1 0.0.0.3
net add link 0.0.0.1 0.0.0.4
net add link 0.0.0.1 0.0.0.5
net add link 0.0.0.2 0.0.0.3
net add link 0.0.0.2 0.0.0.4
net add link 0.0.0.2 0.0.0.5
net add link 0.0.0.3 0.0.0.4
net add link 0.0.0.3 0.0.0.6
net add link 0.0.0.4 0.0.0.7
net add link 0.0.0.5 0.0.0.8
net add link 0.0.0.6 0.0.0.8
net add link 0.0.0.7 0.0.0.8

bgp add router 65532 0.0.0.3
bgp router 0.0.0.3
        add peer 300 0.0.0.6
        peer 0.0.0.6
                filter out
                        add-rule
                                match "prefix in 192.168.0"
                                action deny
                        exit
                        add-rule 
                                match "community is 23767"
                                action accept
                        exit
                        add-rule 
                                match "community is 23766"
                                action accept
                        exit
                        add-rule
                                match "prefix in 140.180.0.0/16"
                                action deny
                        exit
                        add-rule 
                                match "community is 23767"
                                action accept
                        exit
                        add-rule 
                                match "community is 23766"
                                action accept
                        exit
                        add-rule
                                match "prefix in 0.0.0.0/0"
                                action deny
                        exit
                exit
        exit
        peer 0.0.0.6 up
        add peer 65534 0.0.0.1
        peer 0.0.0.1
                filter out
                        add-rule
                                match "prefix in 192.168.0"
                                action deny
                        exit
                        add-rule 
                                match "community is 23767"
                                action accept
                        exit
                        add-rule 
                                match "community is 23766"
                                action accept
                        exit
                        add-rule
                                match "prefix in 140.180.0.0/16"
                                action deny
                        exit
                        add-rule 
                                match "community is 23767"
                                action accept
                        exit
                        add-rule 
                                match "community is 23766"
                                action accept
                        exit
                        add-rule
                                match "prefix in 0.0.0.0/0"
                                action deny
                        exit
                exit
        exit
        peer 0.0.0.1 up
exit
bgp add router 65533 0.0.0.2
bgp router 0.0.0.2
        add peer 200 0.0.0.5
        peer 0.0.0.5
                filter out
                        add-rule
                                match "prefix in 192.168.0"
                                action deny
                        exit
                        add-rule 
                                match "community is 23765"
                                action accept
                        exit
                        add-rule
                                match "prefix in 140.180.0.0/16"
                                action deny
                        exit
                        add-rule 
                                match "community is 23765"
                                action accept
                        exit
                        add-rule
                                match "prefix in 0.0.0.0/0"
                                action deny
                        exit
                exit
        exit
        peer 0.0.0.5 up
        add peer 65534 0.0.0.1
        peer 0.0.0.1
                filter out
                        add-rule
                                match "prefix in 192.168.0"
                                action deny
                        exit
                        add-rule 
                                match "community is 23765"
                                action accept
                        exit
                        add-rule
                                match "prefix in 140.180.0.0/16"
                                action deny
                        exit
                        add-rule 
                                match "community is 23765"
                                action accept
                        exit
                        add-rule
                                match "prefix in 0.0.0.0/0"
                                action deny
                        exit
                exit
        exit
        peer 0.0.0.1 up
exit
bgp add router 65534 0.0.0.1
bgp router 0.0.0.1
        add peer 65532 0.0.0.3
        peer 0.0.0.3
                filter out
                        add-rule
                                match "prefix in 192.168.0"
                                action deny
                        exit
                        add-rule 
                                match "community is 23765"
                                action accept
                        exit
                        add-rule
                                match "prefix in 140.180.0.0/16"
                                action deny
                        exit
                        add-rule 
                                match "community is 23765"
                                action accept
                        exit
                        add-rule
                                match "prefix in 0.0.0.0/0"
                                action deny
                        exit
                exit
        exit
        peer 0.0.0.3 up
        add peer 65533 0.0.0.2
        peer 0.0.0.2
                filter out
                        add-rule
                                match "prefix in 192.168.0"
                                action deny
                        exit
                        add-rule 
                                match "community is 23765"
                                action accept
                        exit
                        add-rule
                                match "prefix in 140.180.0.0/16"
                                action deny
                        exit
                        add-rule 
                                match "community is 23765"
                                action accept
                        exit
                        add-rule
                                match "prefix in 0.0.0.0/0"
                                action deny
                        exit
                exit
        exit
        peer 0.0.0.2 up
exit
sim run

